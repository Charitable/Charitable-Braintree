!function(e){function n(e){function n(e){return{totalPriceStatus:"ESTIMATED",totalPrice:e.format_amount(e.get_amount()),currencyCode:CHARITABLE_VARS.currency,countryCode:CHARITABLE_VARS.country}}function r(e){return{total:{label:CHARITABLE_BRAINTREE_VARS.description,amount:e.format_amount(e.get_amount())},requiredBillingContactFields:["postalAddress"]}}var t,a,o;o=e,braintree.dropin.create((t=o,a={authorization:CHARITABLE_BRAINTREE_VARS.client_token,container:"#charitable-braintree-dropin-container"},"1"===CHARITABLE_BRAINTREE_VARS.paypal&&(a.paypal={flow:"vault"}),"1"===CHARITABLE_BRAINTREE_VARS.venmo&&(a.venmo={}),"1"===CHARITABLE_BRAINTREE_VARS.googlepay&&(a.googlePay={googlePayVersion:2,transactionInfo:n(t),allowedPaymentMethods:[{type:"CARD",parameters:{billingAddressRequired:!0}}]},"1"!==CHARITABLE_VARS.test_mode&&(a.googlePay.merchantId=CHARITABLE_BRAINTREE_VARS.googlepay_merchant_id)),"1"===CHARITABLE_BRAINTREE_VARS.applepay&&(a.applePay={displayName:CHARITABLE_BRAINTREE_VARS.description,paymentRequest:r(t)}),"1"===CHARITABLE_BRAINTREE_VARS.three_d_secure&&(a.threeDSecure=!0),"0"!==CHARITABLE_BRAINTREE_VARS.data_collector&&(a.dataCollector={},a.dataCollector[CHARITABLE_BRAINTREE_VARS.data_collector]=!0),a),function(e,a){i.on("charitable:form:total:changed",function(e,t){a.updateConfiguration("googlePay","transactionInfo",n(t)),a.updateConfiguration("applePay","paymentRequest",r(t))}),i.on("charitable:form:validate",function(e,n){"braintree"===n.get_payment_method()&&0===n.errors.length&&(n.add_pending_process("braintree"),a.requestPaymentMethod(function(n){if("1"!==CHARITABLE_BRAINTREE_VARS.three_d_secure)return{};var a,e=(a={},[{field:"first_name",key:"givenName"},{field:"last_name",key:"surname"},{field:"phone",key:"phoneNumber"},{field:"city",key:"locality"},{field:"country",key:"countryCodeAlpha2"},{field:"address",key:"streetAddress"},{field:"address_2",key:"extendedAddress"},{field:"postcode",key:"postalCode"},{field:"state",key:"region"}].forEach(function(e){var t=n.get_input(e.field);t.length&&t.val().length&&(a[e.key]=t.val())}),a);return{threeDSecure:{email:n.get_email(),amount:n.unformat_amount(n.get_amount()),billingAddress:e}}}(n),function(e,t){if(e)return n.prevent_scroll_to_top=!0,n.remove_pending_process_by_name("braintree"),!1;n.get_input("braintree_nonce").val(t.nonce),n.get_input("braintree_device_data").val(t.deviceData),t.hasOwnProperty("threeDSecureInfo")&&n.get_input("braintree_authentication_id").val(t.threeDSecureInfo.threeDSecureAuthenticationId),n.remove_pending_process_by_name("braintree")}))}),i.on("charitable:form:processed",function(e,t,n){t.success||a.clearSelectedPaymentMethod()})})}var i=jQuery("body");i.on("charitable:form:initialize",function(e,t){n(t)})}();